# source('./Code/Vulnerability/VulnerabilityTable.R')
library(tidyverse)
options(stringsAsFactors = F)
dat <- list()

# Function to create data.frame (just to reduce code)
fuzzy <- function(stressor, trait, category, value) {
  data.frame(stressor = stressor, trait = trait,
             category = category, value = value,
             row.names = NULL)
}

# Traits
#
# Environment:
#   pelagic: occurring mainly in the water column between 0 and 200 m, not feeding on benthic organisms;
#   benthopelagic: living and/or feeding on or near the bottom, as well as in midwater, between 0 and 200 m;
#   demersal: living and/or feeding on or near the bottom, between 0 and 200 m;
#   reef-associated: living and/or feeding on or near reefs, between 0 and 200 m;
#   bathydemersal: living and/or feeding on or near the bottom, below 200 m.
#   bathypelagic: occurring mainly in open water below 200 m, not feeding on benthic organisms; and


# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=   Acidification   =-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
i = 'Acidification'

# Environment
# Acidification is mostly in the deep waters of the St. Lawrence
j = 'Environment'
tr <- c(bathydemersal = 1.0,
        bathypelagic  = 0.0,
        benthic       = 1.0,
        benthopelagic = 0.5,
        demersal      = 1.0,
        pelagic       = 0.0)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

# Vulnerability due to taxa mobility, as a proxy of metabolism (Melzner et al. 2009)
j = 'Mobility'
tr <- c(sessile  = 1.00,
        crawler  = 0.75,
        swimmer  = 0.75,
        burrower = 0.75,
        mobile   = 0.25)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

# Vulnerability due to body composition
j = 'Body composition'
tr <- c(biogenic_silica         = 0.0,
        bone                    = 0.0,
        cartilaginous           = 0.0,
        chitinous               = 0.0,
        non_calcifying          = 0.0,
        soft_aragonite          = 0.0,
        soft_calcite            = 0.0,
        soft_calcium_phosphate  = 0.0,
        soft_calcium_sulfate    = 0.0,
        solid_aragonite         = 1.0,
        solid_calcite           = 0.9,
        solid_calcium_phosphate = 0.9,
        solid_phosphatic        = 0.0)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

# Vulnerability using phylum as proxy  (Kroker et al. 2013)
j = 'Phylum'
tr <- c(Annelida      = 0.0,
        Arthropoda    = 0.9,
        Brachiopoda   = 1.0,
        Bryozoa       = 0.8,
        Chordata      = 0.0,
        Cnidaria      = 0.0,
        Ctenophora    = 0.0,
        Echinodermata = 0.8,
        Echiura       = 0.0,
        Mollusca      = 1.0,
        Porifera      = 0.0,
        Sipuncula     = 0.0)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)


# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=    Coastal development    =-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
i = 'Coastal development'

# Mobility
j = 'Mobility'
tr <- c(sessile  = 1.00,
         crawler  = 0.75,
         swimmer  = 0.75,
         burrower = 0.75,
         mobile   = 0.5)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

# Size
j = 'Size'
tr <- c('0 - 100' = 0.25,
        '100 - 200' = 0.5,
        '200 - 300' = 0.75,
        '300+' = 1)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)


# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=    Direct human impact    =-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
i = 'Direct human impact'

# Mobility
j = 'Mobility'
tr <- c(sessile  = 1.00,
         crawler  = 0.75,
         swimmer  = 0.75,
         burrower = 0.75,
         mobile   = 0.5)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

# Size
j = 'Size'
tr <- c('0 - 100' = 0.25,
        '100 - 200' = 0.5,
        '200 - 300' = 0.75,
        '300+' = 1)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=    Fisheries    =-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# Landings: Targetted vs bycatch
i = 'FisheriesDD'
j = 'Landings'
tr <- c(targeted = 1,
        bycatch = 0.75,
        other = 0)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

i = 'FisheriesDNH'
j = 'Landings'
tr <- c(targeted = 1,
        bycatch = 0.75,
        other = 0)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

i = 'FisheriesDNL'
j = 'Landings'
tr <- c(targeted = 1,
        bycatch = 0.75,
        other = 0)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

i = 'FisheriesPLB'
j = 'Landings'
tr <- c(targeted = 1,
        bycatch = 0.75,
        other = 0)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

i = 'FisheriesPHB'
j = 'Landings'
tr <- c(targeted = 1,
        bycatch = 0.75,
        other = 0)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)


# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=     Hypoxia     =-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
i = 'Hypoxia'

# Environment
# Hypoxia is mostly in the deep waters of the St. Lawrence
j = 'Environment'
tr <- c(bathydemersal = 1.0,
        bathypelagic  = 0.0,
        benthic       = 1.0,
        benthopelagic = 0.5,
        demersal      = 1.0,
        pelagic       = 0.0)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

# Vulnerability due to taxa mobility
j = 'Mobility'
tr <- c(sessile  = 1.00,
        crawler  = 0.75,
        swimmer  = 0.75,
        burrower = 0.75,
        mobile   = 0.25)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)


# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=    Inorganic pollution    =-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
i = 'Inorganic pollution'

# Vulnerability due to the feeding type (see Ellis et al. 2017)
j = 'Feeding type'
tr <- c(deposit     = 0.75,
          filter      = 0.00,
          grazer      = 0.00,
          parasite    = 0.00,
          plankton    = 0.00,
          predator    = 0.00,
          scavenger   = 0.50,
          suspension  = 1.00,
          xylophagous = 0.00)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)


# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=     Organic pollution     =-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
i = 'Organic pollution'

# Vulnerability due to the feeding type (see Ellis et al. 2017)
j = 'Feeding type'
tr <- c(deposit     = 0.75,
          filter      = 0.00,
          grazer      = 0.00,
          parasite    = 0.00,
          plankton    = 0.00,
          predator    = 0.00,
          scavenger   = 0.50,
          suspension  = 1.00,
          xylophagous = 0.00)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)


# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=      Marine pollution     =-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
i = 'Organic pollution'

# Vulnerability due to the feeding type (see Ellis et al. 2017)
j = 'Feeding type'
tr <- c(deposit     = 0.75,
          filter      = 0.00,
          grazer      = 0.00,
          parasite    = 0.00,
          plankton    = 0.00,
          predator    = 0.00,
          scavenger   = 0.50,
          suspension  = 1.00,
          xylophagous = 0.00)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)


# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=    Nutrient pollution     =-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
i = 'Nutrient pollution'

# Vulnerability due to the feeding type (see Ellis et al. 2017)
j = 'Feeding type'
tr <- c(deposit     = 0.75,
          filter      = 0.00,
          grazer      = 0.00,
          parasite    = 0.00,
          plankton    = 0.00,
          predator    = 0.00,
          scavenger   = 0.50,
          suspension  = 1.00,
          xylophagous = 0.00)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)


# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=    Sea bottom temperature   =-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
i = 'Sea bottom temperature'

# Environment
j = 'Environment'
tr <- c(bathydemersal = 1.0,
        bathypelagic  = 0.0,
        benthic       = 1.0,
        benthopelagic = 0.5,
        demersal      = 1.0,
        pelagic       = 0.0)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

# Vulnerability due to taxa mobility
j = 'Mobility'
tr <- c(sessile  = 1.00,
        crawler  = 0.75,
        swimmer  = 0.75,
        burrower = 0.75,
        mobile   = 0.25)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)


# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=   Sea surface temperature   =-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
i = 'Sea surface temperature'

# Environment
j = 'Environment'
tr <- c(bathydemersal = 0.0,
        bathypelagic  = 0.0,
        benthic       = 0.0,
        benthopelagic = 0.5,
        demersal      = 0.0,
        pelagic       = 1.0)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

# Vulnerability due to taxa mobility
j = 'Mobility'
tr <- c(sessile  = 1.00,
        crawler  = 0.75,
        swimmer  = 0.75,
        burrower = 0.75,
        mobile   = 0.25)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)


# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=    Shipping     =-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
i = 'Shipping'

# Environment
j = 'Environment'
tr <- c(bathydemersal = 0.0,
         bathypelagic  = 0.0,
         benthic       = 0.0,
         benthopelagic = 0.5,
         demersal      = 0.0,
         pelagic       = 1.0)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)

# Size
j = 'Size'
tr <- c('0 - 100' = 0.0,
        '100 - 200' = 0.5,
        '200 - 300' = 0.75,
        '300+' = 1)
dat[[i]][[j]] <- fuzzy(i, j, names(tr), tr)


# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=   Data.frame    =-=-=-=-=-=-=-=-=-=-=-=-= #
# =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= #
df <- dat
for(i in 1:length(df)) df[[i]] <- bind_rows(df[[i]])
df <- bind_rows(df)

# Export
save(df, file = './Data/VulnerabilityTable/VulnerabilityTable.RData')
